# 2025年10月10日 作業ログ

## 作業概要
並び替え問題のレベル設定修正作業

## 完了した作業
1. ✅ 長文読解の選択肢記号重複修正（A)A. → A)）
2. ✅ 並び替え問題の詳細レベル設定強化
3. ✅ 準2級の並び替え専用設定追加（jumbled_tokens, jumbled_patterns等）
4. ✅ 3級の並び替え専用設定追加
5. ✅ 並び替え問題のプロンプト修正

## 現在の問題
**並び替え問題のレベル調整が不完全**

### 具体的な問題
- 文の長さが適切でない
- 出てくる単語が適切ではない
- 全ての級でレベル調整が合っていない

### 現在の設定状況
- 準2級: jumbled_tokens: { min: 12, max: 16 } - 設定済み
- 3級: jumbled_tokens: { min: 8, max: 10 } - 設定済み
- 他の級（5級、4級、2級、準1級、1級）: 並び替え専用設定が未設定

### 次回の作業予定
1. 全級の並び替え専用設定を追加
2. 各級に応じた適切な文長と語彙レベルの設定
3. プロンプトの詳細化とテスト
4. 全級での動作確認

## 技術的詳細

### 修正したファイル
- `/Users/round/EnglishAPP/api/generate.js`

### 追加した設定例
```javascript
'準2級': {
  // 並べ替え問題専用設定（詳細仕様準拠）
  jumbled_tokens: { min: 12, max: 16 },
  jumbled_anchors: { min: 2, max: 3 },
  jumbled_movables: { min: 2, max: 3 },
  jumbled_grammar_tier: 4,
  jumbled_patterns: ['P1', 'P2', 'P3'],
  jumbled_pattern_descriptions: {
    'P1': '受動態 (現在/過去) ※完了形は不可',
    'P2': 'to不定詞（副詞的目的/結果） ※「to + 動詞原形」の一塊',
    'P3': 'that節の目的語（think/say/know + that + SV）※関係代名詞ではない'
  },
  jumbled_banned_grammar: ['現在完了', '過去完了', '関係代名詞', '関係副詞', '高度な倒置', '分詞構文の多重化', '学術語'],
  jumbled_lexicon: '高頻度語(NGSL 1–2000相当)中心',
  jumbled_difficulty_range: { min: 0.54, max: 0.62 },
  // ... 他の設定
}
```

### 現在のデプロイURL
- `https://english-ayvuok004-mitama.vercel.app`

## 明日の作業計画
1. **全級の並び替え専用設定追加**
   - 5級、4級、2級、準1級、1級のjumbled_tokens設定
   - 各級に応じたjumbled_patterns設定
   - 適切な語彙レベル設定

2. **プロンプトの詳細化**
   - 各級の具体的な文法項目と語彙レベルの明記
   - 文長制約の厳密な適用
   - 語彙難易度の調整

3. **テストと検証**
   - 全級での並び替え問題生成テスト
   - 文長と語彙レベルの確認
   - 必要に応じた微調整

## 注意事項
- 並び替え問題は他の問題タイプと異なり、専用の設定が必要
- 各級のjumbled_tokens設定が重要
- プロンプトで詳細設定を正しく参照する必要がある
